<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>::Employee::</title>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Redux Toolkit -->
    <script src="https://unpkg.com/@reduxjs/toolkit@1.9.5/dist/redux-toolkit.umd.js"></script>
    <script src="https://unpkg.com/react-redux@8.1.1/dist/react-redux.min.js"></script>
    
    <!-- Material UI -->
    <script src="https://unpkg.com/@mui/material@5.14.1/umd/material-ui.production.min.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Material UI Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background-color: #f5f5f5;
        }
        #root {
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { createSlice, configureStore } = RTK;
        const { Provider, useSelector, useDispatch } = ReactRedux;
        const { 
            AppBar, Toolbar, Typography, Container, Grid, Card, CardContent, 
            Button, TextField, Dialog, DialogTitle, DialogContent, DialogActions,
            Table, TableBody, TableCell, TableContainer, TableHead, TableRow,
            Paper, IconButton, Box, Drawer, List, ListItem, ListItemButton,
            ListItemIcon, ListItemText, CssBaseline, ThemeProvider, createTheme,
            Select, MenuItem, FormControl, InputLabel, Snackbar, Alert, Tabs, Tab
        } = MaterialUI;

        // Custom Icon Components using Unicode symbols
        const CustomIcons = {
            Add: () => React.createElement('span', { style: { fontSize: '20px' } }, '➕'),
            Edit: () => React.createElement('span', { style: { fontSize: '18px' } }, '✏️'),
            Delete: () => React.createElement('span', { style: { fontSize: '18px' } }, '🗑️'),
            Business: () => React.createElement('span', { style: { fontSize: '20px' } }, '🏢'),
            Work: () => React.createElement('span', { style: { fontSize: '20px' } }, '💼'),
            Person: () => React.createElement('span', { style: { fontSize: '20px' } }, '👤'),
            Menu: () => React.createElement('span', { style: { fontSize: '20px' } }, '☰'),
            Dashboard: () => React.createElement('span', { style: { fontSize: '20px' } }, '📊')
        };

        // Theme
        const theme = createTheme({
            palette: {
                primary: {
                    main: '#1976d2',
                },
                secondary: {
                    main: '#dc004e',
                },
            },
        });

        // Redux Slices
        const departmentSlice = createSlice({
            name: 'departments',
            initialState: {
                items: [
                    { id: 1, name: 'Engineering', description: 'Software Development' },
                    { id: 2, name: 'HR', description: 'Human Resources' },
                    { id: 3, name: 'Sales', description: 'Sales and Marketing' }
                ],
                nextId: 4
            },
            reducers: {
                addDepartment: (state, action) => {
                    state.items.push({ ...action.payload, id: state.nextId++ });
                },
                updateDepartment: (state, action) => {
                    const index = state.items.findIndex(item => item.id === action.payload.id);
                    if (index !== -1) {
                        state.items[index] = action.payload;
                    }
                },
                deleteDepartment: (state, action) => {
                    state.items = state.items.filter(item => item.id !== action.payload);
                }
            }
        });

        const jobRoleSlice = createSlice({
            name: 'jobRoles',
            initialState: {
                items: [
                    { id: 1, title: 'Software Engineer', departmentId: 1, description: 'Full Stack Developer' },
                    { id: 2, title: 'HR Manager', departmentId: 2, description: 'Human Resources Manager' },
                    { id: 3, title: 'Sales Executive', departmentId: 3, description: 'Sales Representative' }
                ],
                nextId: 4
            },
            reducers: {
                addJobRole: (state, action) => {
                    state.items.push({ ...action.payload, id: state.nextId++ });
                },
                updateJobRole: (state, action) => {
                    const index = state.items.findIndex(item => item.id === action.payload.id);
                    if (index !== -1) {
                        state.items[index] = action.payload;
                    }
                },
                deleteJobRole: (state, action) => {
                    state.items = state.items.filter(item => item.id !== action.payload);
                }
            }
        });

        const employeeSlice = createSlice({
            name: 'employees',
            initialState: {
                items: [
                    { 
                        id: 1, 
                        firstName: 'John', 
                        lastName: 'Doe', 
                        email: 'john@example.com', 
                        departmentId: 1, 
                        jobRoleId: 1,
                        salary: 75000
                    },
                    { 
                        id: 2, 
                        firstName: 'Jane', 
                        lastName: 'Smith', 
                        email: 'jane@example.com', 
                        departmentId: 2, 
                        jobRoleId: 2,
                        salary: 80000
                    }
                ],
                nextId: 3
            },
            reducers: {
                addEmployee: (state, action) => {
                    state.items.push({ ...action.payload, id: state.nextId++ });
                },
                updateEmployee: (state, action) => {
                    const index = state.items.findIndex(item => item.id === action.payload.id);
                    if (index !== -1) {
                        state.items[index] = action.payload;
                    }
                },
                deleteEmployee: (state, action) => {
                    state.items = state.items.filter(item => item.id !== action.payload);
                }
            }
        });

        const uiSlice = createSlice({
            name: 'ui',
            initialState: {
                currentPage: 'dashboard',
                snackbar: { open: false, message: '', severity: 'success' }
            },
            reducers: {
                setCurrentPage: (state, action) => {
                    state.currentPage = action.payload;
                },
                showSnackbar: (state, action) => {
                    state.snackbar = { open: true, ...action.payload };
                },
                hideSnackbar: (state) => {
                    state.snackbar.open = false;
                }
            }
        });

        // Store
        const store = configureStore({
            reducer: {
                departments: departmentSlice.reducer,
                jobRoles: jobRoleSlice.reducer,
                employees: employeeSlice.reducer,
                ui: uiSlice.reducer
            }
        });

        // Actions
        const { addDepartment, updateDepartment, deleteDepartment } = departmentSlice.actions;
        const { addJobRole, updateJobRole, deleteJobRole } = jobRoleSlice.actions;
        const { addEmployee, updateEmployee, deleteEmployee } = employeeSlice.actions;
        const { setCurrentPage, showSnackbar, hideSnackbar } = uiSlice.actions;

        // Components
        const Header = () => {
            const dispatch = useDispatch();
            const currentPage = useSelector(state => state.ui.currentPage);

            const menuItems = [
                { text: 'Dashboard', page: 'dashboard', icon: React.createElement(CustomIcons.Dashboard) },
                { text: 'Departments', page: 'departments', icon: React.createElement(CustomIcons.Business) },
                { text: 'Job Roles', page: 'job-roles', icon: React.createElement(CustomIcons.Work) },
                { text: 'Employees', page: 'employees', icon: React.createElement(CustomIcons.Person) }
            ];

            const handleTabChange = (event, newValue) => {
                const selectedItem = menuItems[newValue];
                dispatch(setCurrentPage(selectedItem.page));
            };

            const currentTabIndex = menuItems.findIndex(item => item.page === currentPage);

            return (
                <AppBar position="fixed" sx={{ zIndex: (theme) => theme.zIndex.drawer + 1 }}>
                    <Toolbar sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center', py: 1 }}>
                        <Typography variant="h6" component="div" sx={{ mb: 1, textAlign: 'center' }}>
                            Employee Management System
                        </Typography>
                        <Tabs 
                            value={currentTabIndex >= 0 ? currentTabIndex : 0}
                            onChange={handleTabChange}
                            sx={{ 
                                '& .MuiTab-root': { 
                                    color: 'rgba(255, 255, 255, 0.7)',
                                    fontWeight: 'medium',
                                    minWidth: 120
                                },
                                '& .Mui-selected': { 
                                    color: 'white !important',
                                    fontWeight: 'bold'
                                },
                                '& .MuiTabs-indicator': {
                                    backgroundColor: 'white',
                                    height: 3
                                }
                            }}
                            centered
                        >
                            {menuItems.map((item, index) => (
                                <Tab 
                                    key={item.page}
                                    label={
                                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
                                            {item.icon}
                                            <span>{item.text}</span>
                                        </Box>
                                    }
                                />
                            ))}
                        </Tabs>
                    </Toolbar>
                </AppBar>
            );
        };

        const Dashboard = () => {
            const departments = useSelector(state => state.departments.items);
            const jobRoles = useSelector(state => state.jobRoles.items);
            const employees = useSelector(state => state.employees.items);

            return (
                <Box sx={{ width: '100%' }}>
                    <Typography 
                        variant="h4" 
                        component="h1" 
                        gutterBottom 
                        sx={{ 
                            textAlign: 'center', 
                            mb: 4,
                            fontWeight: 'bold',
                            color: 'primary.main' 
                        }}
                    >
                        Dashboard
                    </Typography>
                    <Container maxWidth="lg">
                        <Grid container spacing={3} justifyContent="center">
                            <Grid item xs={12} sm={6} md={4}>
                                <Card 
                                    sx={{ 
                                        textAlign: 'center',
                                        height: '100%',
                                        display: 'flex',
                                        flexDirection: 'column',
                                        justifyContent: 'center',
                                        boxShadow: 3,
                                        '&:hover': { boxShadow: 6 }
                                    }}
                                >
                                    <CardContent sx={{ py: 4 }}>
                                        <Typography color="textSecondary" gutterBottom variant="h6">
                                            Total Departments
                                        </Typography>
                                        <Typography variant="h3" sx={{ fontWeight: 'bold', color: 'primary.main' }}>
                                            {departments.length}
                                        </Typography>
                                    </CardContent>
                                </Card>
                            </Grid>
                            <Grid item xs={12} sm={6} md={4}>
                                <Card 
                                    sx={{ 
                                        textAlign: 'center',
                                        height: '100%',
                                        display: 'flex',
                                        flexDirection: 'column',
                                        justifyContent: 'center',
                                        boxShadow: 3,
                                        '&:hover': { boxShadow: 6 }
                                    }}
                                >
                                    <CardContent sx={{ py: 4 }}>
                                        <Typography color="textSecondary" gutterBottom variant="h6">
                                            Total Job Roles
                                        </Typography>
                                        <Typography variant="h3" sx={{ fontWeight: 'bold', color: 'secondary.main' }}>
                                            {jobRoles.length}
                                        </Typography>
                                    </CardContent>
                                </Card>
                            </Grid>
                            <Grid item xs={12} sm={6} md={4}>
                                <Card 
                                    sx={{ 
                                        textAlign: 'center',
                                        height: '100%',
                                        display: 'flex',
                                        flexDirection: 'column',
                                        justifyContent: 'center',
                                        boxShadow: 3,
                                        '&:hover': { boxShadow: 6 }
                                    }}
                                >
                                    <CardContent sx={{ py: 4 }}>
                                        <Typography color="textSecondary" gutterBottom variant="h6">
                                            Total Employees
                                        </Typography>
                                        <Typography variant="h3" sx={{ fontWeight: 'bold', color: 'success.main' }}>
                                            {employees.length}
                                        </Typography>
                                    </CardContent>
                                </Card>
                            </Grid>
                        </Grid>
                    </Container>
                </Box>
            );
        };

        // Department Components
        const DepartmentForm = ({ department, onSave, onCancel }) => {
            const [formData, setFormData] = React.useState({
                name: department?.name || '',
                description: department?.description || ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(department ? { ...department, ...formData } : formData);
            };

            return (
                <form onSubmit={handleSubmit}>
                    <DialogContent>
                        <TextField
                            autoFocus
                            margin="dense"
                            label="Department Name"
                            fullWidth
                            variant="outlined"
                            value={formData.name}
                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                            required
                        />
                        <TextField
                            margin="dense"
                            label="Description"
                            fullWidth
                            variant="outlined"
                            multiline
                            rows={3}
                            value={formData.description}
                            onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                            required
                        />
                    </DialogContent>
                    <DialogActions>
                        <Button onClick={onCancel}>Cancel</Button>
                        <Button type="submit" variant="contained">
                            {department ? 'Update' : 'Create'}
                        </Button>
                    </DialogActions>
                </form>
            );
        };

        const Departments = () => {
            const dispatch = useDispatch();
            const departments = useSelector(state => state.departments.items);
            const [dialogOpen, setDialogOpen] = React.useState(false);
            const [editingDepartment, setEditingDepartment] = React.useState(null);

            const handleAdd = () => {
                setEditingDepartment(null);
                setDialogOpen(true);
            };

            const handleEdit = (department) => {
                setEditingDepartment(department);
                setDialogOpen(true);
            };

            const handleSave = (departmentData) => {
                if (editingDepartment) {
                    dispatch(updateDepartment(departmentData));
                    dispatch(showSnackbar({ message: 'Department updated successfully!', severity: 'success' }));
                } else {
                    dispatch(addDepartment(departmentData));
                    dispatch(showSnackbar({ message: 'Department created successfully!', severity: 'success' }));
                }
                setDialogOpen(false);
            };

            const handleDelete = (id) => {
                if (window.confirm('Are you sure you want to delete this department?')) {
                    dispatch(deleteDepartment(id));
                    dispatch(showSnackbar({ message: 'Department deleted successfully!', severity: 'success' }));
                }
            };

            return (
                <React.Fragment>
                    <Box sx={{ width: '100%' }}>
                        <Box 
                            sx={{ 
                                display: 'flex', 
                                justifyContent: 'space-between', 
                                alignItems: 'center', 
                                mb: 4,
                                flexWrap: 'wrap',
                                gap: 2
                            }}
                        >
                            <Typography 
                                variant="h4" 
                                component="h1" 
                                sx={{ 
                                    fontWeight: 'bold',
                                    color: 'primary.main',
                                    flexGrow: 1,
                                    textAlign: { xs: 'center', md: 'left' }
                                }}
                            >
                                Departments
                            </Typography>
                            <Button 
                                variant="contained" 
                                startIcon={<CustomIcons.Add />} 
                                onClick={handleAdd}
                                size="large"
                                sx={{ 
                                    boxShadow: 2,
                                    '&:hover': { boxShadow: 4 }
                                }}
                            >
                                Add Department
                            </Button>
                        </Box>

                        <Container maxWidth="lg" disableGutters>
                            <Paper 
                                sx={{ 
                                    width: '100%', 
                                    overflow: 'hidden',
                                    boxShadow: 3,
                                    borderRadius: 2
                                }}
                            >
                                <TableContainer>
                                    <Table stickyHeader>
                                        <TableHead>
                                            <TableRow>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Name
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Description
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Actions
                                                </TableCell>
                                            </TableRow>
                                        </TableHead>
                                        <TableBody>
                                            {departments.map((department, index) => (
                                                <TableRow 
                                                    key={department.id}
                                                    sx={{ 
                                                        '&:nth-of-type(odd)': { bgcolor: 'action.hover' },
                                                        '&:hover': { bgcolor: 'action.selected' }
                                                    }}
                                                >
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body1" fontWeight="medium">
                                                            {department.name}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body2" color="text.secondary">
                                                            {department.description}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Box sx={{ display: 'flex', justifyContent: 'center', gap: 1 }}>
                                                            <IconButton 
                                                                onClick={() => handleEdit(department)} 
                                                                color="primary"
                                                                size="large"
                                                                sx={{ 
                                                                    '&:hover': { bgcolor: 'primary.light', color: 'white' }
                                                                }}
                                                            >
                                                                <CustomIcons.Edit />
                                                            </IconButton>
                                                            <IconButton 
                                                                onClick={() => handleDelete(department.id)} 
                                                                color="error"
                                                                size="large"
                                                                sx={{ 
                                                                    '&:hover': { bgcolor: 'error.light', color: 'white' }
                                                                }}
                                                            >
                                                                <CustomIcons.Delete />
                                                            </IconButton>
                                                        </Box>
                                                    </TableCell>
                                                </TableRow>
                                            ))}
                                        </TableBody>
                                    </Table>
                                </TableContainer>
                            </Paper>
                        </Container>
                    </Box>

                    <Dialog open={dialogOpen} onClose={() => setDialogOpen(false)} maxWidth="sm" fullWidth>
                        <DialogTitle>
                            {editingDepartment ? 'Edit Department' : 'Add Department'}
                        </DialogTitle>
                        <DepartmentForm
                            department={editingDepartment}
                            onSave={handleSave}
                            onCancel={() => setDialogOpen(false)}
                        />
                    </Dialog>
                </React.Fragment>
            );
        };

        // Job Role Components
        const JobRoleForm = ({ jobRole, onSave, onCancel }) => {
            const departments = useSelector(state => state.departments.items);
            const [formData, setFormData] = React.useState({
                title: jobRole?.title || '',
                departmentId: jobRole?.departmentId || '',
                description: jobRole?.description || ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(jobRole ? { ...jobRole, ...formData } : formData);
            };

            return (
                <form onSubmit={handleSubmit}>
                    <DialogContent>
                        <TextField
                            autoFocus
                            margin="dense"
                            label="Job Title"
                            fullWidth
                            variant="outlined"
                            value={formData.title}
                            onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                            required
                        />
                        <FormControl fullWidth margin="dense" variant="outlined" required>
                            <InputLabel>Department</InputLabel>
                            <Select
                                value={formData.departmentId}
                                onChange={(e) => setFormData({ ...formData, departmentId: e.target.value })}
                                label="Department"
                            >
                                {departments.map((dept) => (
                                    <MenuItem key={dept.id} value={dept.id}>
                                        {dept.name}
                                    </MenuItem>
                                ))}
                            </Select>
                        </FormControl>
                        <TextField
                            margin="dense"
                            label="Description"
                            fullWidth
                            variant="outlined"
                            multiline
                            rows={3}
                            value={formData.description}
                            onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                            required
                        />
                    </DialogContent>
                    <DialogActions>
                        <Button onClick={onCancel}>Cancel</Button>
                        <Button type="submit" variant="contained">
                            {jobRole ? 'Update' : 'Create'}
                        </Button>
                    </DialogActions>
                </form>
            );
        };

        const JobRoles = () => {
            const dispatch = useDispatch();
            const jobRoles = useSelector(state => state.jobRoles.items);
            const departments = useSelector(state => state.departments.items);
            const [dialogOpen, setDialogOpen] = React.useState(false);
            const [editingJobRole, setEditingJobRole] = React.useState(null);

            const getDepartmentName = (departmentId) => {
                const dept = departments.find(d => d.id === departmentId);
                return dept ? dept.name : 'Unknown';
            };

            const handleAdd = () => {
                setEditingJobRole(null);
                setDialogOpen(true);
            };

            const handleEdit = (jobRole) => {
                setEditingJobRole(jobRole);
                setDialogOpen(true);
            };

            const handleSave = (jobRoleData) => {
                if (editingJobRole) {
                    dispatch(updateJobRole(jobRoleData));
                    dispatch(showSnackbar({ message: 'Job role updated successfully!', severity: 'success' }));
                } else {
                    dispatch(addJobRole(jobRoleData));
                    dispatch(showSnackbar({ message: 'Job role created successfully!', severity: 'success' }));
                }
                setDialogOpen(false);
            };

            const handleDelete = (id) => {
                if (window.confirm('Are you sure you want to delete this job role?')) {
                    dispatch(deleteJobRole(id));
                    dispatch(showSnackbar({ message: 'Job role deleted successfully!', severity: 'success' }));
                }
            };

            return (
                <React.Fragment>
                    <Box sx={{ width: '100%' }}>
                        <Box 
                            sx={{ 
                                display: 'flex', 
                                justifyContent: 'space-between', 
                                alignItems: 'center', 
                                mb: 4,
                                flexWrap: 'wrap',
                                gap: 2
                            }}
                        >
                            <Typography 
                                variant="h4" 
                                component="h1" 
                                sx={{ 
                                    fontWeight: 'bold',
                                    color: 'primary.main',
                                    flexGrow: 1,
                                    textAlign: { xs: 'center', md: 'left' }
                                }}
                            >
                                Job Roles
                            </Typography>
                            <Button 
                                variant="contained" 
                                startIcon={<CustomIcons.Add />} 
                                onClick={handleAdd}
                                size="large"
                                sx={{ 
                                    boxShadow: 2,
                                    '&:hover': { boxShadow: 4 }
                                }}
                            >
                                Add Job Role
                            </Button>
                        </Box>

                        <Container maxWidth="lg" disableGutters>
                            <Paper 
                                sx={{ 
                                    width: '100%', 
                                    overflow: 'hidden',
                                    boxShadow: 3,
                                    borderRadius: 2
                                }}
                            >
                                <TableContainer>
                                    <Table stickyHeader>
                                        <TableHead>
                                            <TableRow>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Title
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Department
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Description
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Actions
                                                </TableCell>
                                            </TableRow>
                                        </TableHead>
                                        <TableBody>
                                            {jobRoles.map((jobRole, index) => (
                                                <TableRow 
                                                    key={jobRole.id}
                                                    sx={{ 
                                                        '&:nth-of-type(odd)': { bgcolor: 'action.hover' },
                                                        '&:hover': { bgcolor: 'action.selected' }
                                                    }}
                                                >
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body1" fontWeight="medium">
                                                            {jobRole.title}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body2" color="text.secondary">
                                                            {getDepartmentName(jobRole.departmentId)}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body2" color="text.secondary">
                                                            {jobRole.description}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Box sx={{ display: 'flex', justifyContent: 'center', gap: 1 }}>
                                                            <IconButton 
                                                                onClick={() => handleEdit(jobRole)} 
                                                                color="primary"
                                                                size="large"
                                                                sx={{ 
                                                                    '&:hover': { bgcolor: 'primary.light', color: 'white' }
                                                                }}
                                                            >
                                                                <CustomIcons.Edit />
                                                            </IconButton>
                                                            <IconButton 
                                                                onClick={() => handleDelete(jobRole.id)} 
                                                                color="error"
                                                                size="large"
                                                                sx={{ 
                                                                    '&:hover': { bgcolor: 'error.light', color: 'white' }
                                                                }}
                                                            >
                                                                <CustomIcons.Delete />
                                                            </IconButton>
                                                        </Box>
                                                    </TableCell>
                                                </TableRow>
                                            ))}
                                        </TableBody>
                                    </Table>
                                </TableContainer>
                            </Paper>
                        </Container>
                    </Box>

                    <Dialog open={dialogOpen} onClose={() => setDialogOpen(false)} maxWidth="sm" fullWidth>
                        <DialogTitle>
                            {editingJobRole ? 'Edit Job Role' : 'Add Job Role'}
                        </DialogTitle>
                        <JobRoleForm
                            jobRole={editingJobRole}
                            onSave={handleSave}
                            onCancel={() => setDialogOpen(false)}
                        />
                    </Dialog>
                </React.Fragment>
            );
        };

        // Employee Components
        const EmployeeForm = ({ employee, onSave, onCancel }) => {
            const departments = useSelector(state => state.departments.items);
            const jobRoles = useSelector(state => state.jobRoles.items);
            const [formData, setFormData] = React.useState({
                firstName: employee?.firstName || '',
                lastName: employee?.lastName || '',
                email: employee?.email || '',
                departmentId: employee?.departmentId || '',
                jobRoleId: employee?.jobRoleId || '',
                salary: employee?.salary || ''
            });

            const filteredJobRoles = jobRoles.filter(role => role.departmentId === formData.departmentId);

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(employee ? { ...employee, ...formData } : formData);
            };

            return (
                <form onSubmit={handleSubmit}>
                    <DialogContent>
                        <Grid container spacing={2}>
                            <Grid item xs={6}>
                                <TextField
                                    autoFocus
                                    margin="dense"
                                    label="First Name"
                                    fullWidth
                                    variant="outlined"
                                    value={formData.firstName}
                                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}
                                    required
                                />
                            </Grid>
                            <Grid item xs={6}>
                                <TextField
                                    margin="dense"
                                    label="Last Name"
                                    fullWidth
                                    variant="outlined"
                                    value={formData.lastName}
                                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}
                                    required
                                />
                            </Grid>
                            <Grid item xs={12}>
                                <TextField
                                    margin="dense"
                                    label="Email"
                                    type="email"
                                    fullWidth
                                    variant="outlined"
                                    value={formData.email}
                                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                                    required
                                />
                            </Grid>
                            <Grid item xs={6}>
                                <FormControl fullWidth margin="dense" variant="outlined" required>
                                    <InputLabel>Department</InputLabel>
                                    <Select
                                        value={formData.departmentId}
                                        onChange={(e) => setFormData({ 
                                            ...formData, 
                                            departmentId: e.target.value,
                                            jobRoleId: '' // Reset job role when department changes
                                        })}
                                        label="Department"
                                    >
                                        {departments.map((dept) => (
                                            <MenuItem key={dept.id} value={dept.id}>
                                                {dept.name}
                                            </MenuItem>
                                        ))}
                                    </Select>
                                </FormControl>
                            </Grid>
                            <Grid item xs={6}>
                                <FormControl fullWidth margin="dense" variant="outlined" required>
                                    <InputLabel>Job Role</InputLabel>
                                    <Select
                                        value={formData.jobRoleId}
                                        onChange={(e) => setFormData({ ...formData, jobRoleId: e.target.value })}
                                        label="Job Role"
                                        disabled={!formData.departmentId}
                                    >
                                        {filteredJobRoles.map((role) => (
                                            <MenuItem key={role.id} value={role.id}>
                                                {role.title}
                                            </MenuItem>
                                        ))}
                                    </Select>
                                </FormControl>
                            </Grid>
                            <Grid item xs={12}>
                                <TextField
                                    margin="dense"
                                    label="Salary"
                                    type="number"
                                    fullWidth
                                    variant="outlined"
                                    value={formData.salary}
                                    onChange={(e) => setFormData({ ...formData, salary: parseInt(e.target.value) })}
                                    required
                                />
                            </Grid>
                        </Grid>
                    </DialogContent>
                    <DialogActions>
                        <Button onClick={onCancel}>Cancel</Button>
                        <Button type="submit" variant="contained">
                            {employee ? 'Update' : 'Create'}
                        </Button>
                    </DialogActions>
                </form>
            );
        };

        const Employees = () => {
            const dispatch = useDispatch();
            const employees = useSelector(state => state.employees.items);
            const departments = useSelector(state => state.departments.items);
            const jobRoles = useSelector(state => state.jobRoles.items);
            const [dialogOpen, setDialogOpen] = React.useState(false);
            const [editingEmployee, setEditingEmployee] = React.useState(null);

            const getDepartmentName = (departmentId) => {
                const dept = departments.find(d => d.id === departmentId);
                return dept ? dept.name : 'Unknown';
            };

            const getJobRoleName = (jobRoleId) => {
                const role = jobRoles.find(r => r.id === jobRoleId);
                return role ? role.title : 'Unknown';
            };

            const handleAdd = () => {
                setEditingEmployee(null);
                setDialogOpen(true);
            };

            const handleEdit = (employee) => {
                setEditingEmployee(employee);
                setDialogOpen(true);
            };

            const handleSave = (employeeData) => {
                if (editingEmployee) {
                    dispatch(updateEmployee(employeeData));
                    dispatch(showSnackbar({ message: 'Employee updated successfully!', severity: 'success' }));
                } else {
                    dispatch(addEmployee(employeeData));
                    dispatch(showSnackbar({ message: 'Employee created successfully!', severity: 'success' }));
                }
                setDialogOpen(false);
            };

            const handleDelete = (id) => {
                if (window.confirm('Are you sure you want to delete this employee?')) {
                    dispatch(deleteEmployee(id));
                    dispatch(showSnackbar({ message: 'Employee deleted successfully!', severity: 'success' }));
                }
            };

            return (
                <React.Fragment>
                    <Box sx={{ width: '100%' }}>
                        <Box 
                            sx={{ 
                                display: 'flex', 
                                justifyContent: 'space-between', 
                                alignItems: 'center', 
                                mb: 4,
                                flexWrap: 'wrap',
                                gap: 2
                            }}
                        >
                            <Typography 
                                variant="h4" 
                                component="h1" 
                                sx={{ 
                                    fontWeight: 'bold',
                                    color: 'primary.main',
                                    flexGrow: 1,
                                    textAlign: { xs: 'center', md: 'left' }
                                }}
                            >
                                Employees
                            </Typography>
                            <Button 
                                variant="contained" 
                                startIcon={<CustomIcons.Add />} 
                                onClick={handleAdd}
                                size="large"
                                sx={{ 
                                    boxShadow: 2,
                                    '&:hover': { boxShadow: 4 }
                                }}
                            >
                                Add Employee
                            </Button>
                        </Box>

                        <Container maxWidth="xl" disableGutters>
                            <Paper 
                                sx={{ 
                                    width: '100%', 
                                    overflow: 'hidden',
                                    boxShadow: 3,
                                    borderRadius: 2
                                }}
                            >
                                <TableContainer>
                                    <Table stickyHeader>
                                        <TableHead>
                                            <TableRow>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Name
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Email
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Department
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Job Role
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Salary
                                                </TableCell>
                                                <TableCell 
                                                    align="center" 
                                                    sx={{ 
                                                        fontWeight: 'bold',
                                                        fontSize: '1.1rem',
                                                        bgcolor: 'primary.main',
                                                        color: 'primary.contrastText'
                                                    }}
                                                >
                                                    Actions
                                                </TableCell>
                                            </TableRow>
                                        </TableHead>
                                        <TableBody>
                                            {employees.map((employee, index) => (
                                                <TableRow 
                                                    key={employee.id}
                                                    sx={{ 
                                                        '&:nth-of-type(odd)': { bgcolor: 'action.hover' },
                                                        '&:hover': { bgcolor: 'action.selected' }
                                                    }}
                                                >
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body1" fontWeight="medium">
                                                            {`${employee.firstName} ${employee.lastName}`}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body2" color="text.secondary">
                                                            {employee.email}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body2" color="text.secondary">
                                                            {getDepartmentName(employee.departmentId)}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body2" color="text.secondary">
                                                            {getJobRoleName(employee.jobRoleId)}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Typography variant="body1" fontWeight="medium" color="success.main">
                                                            ${employee.salary.toLocaleString()}
                                                        </Typography>
                                                    </TableCell>
                                                    <TableCell align="center" sx={{ py: 2 }}>
                                                        <Box sx={{ display: 'flex', justifyContent: 'center', gap: 1 }}>
                                                            <IconButton 
                                                                onClick={() => handleEdit(employee)} 
                                                                color="primary"
                                                                size="large"
                                                                sx={{ 
                                                                    '&:hover': { bgcolor: 'primary.light', color: 'white' }
                                                                }}
                                                            >
                                                                <CustomIcons.Edit />
                                                            </IconButton>
                                                            <IconButton 
                                                                onClick={() => handleDelete(employee.id)} 
                                                                color="error"
                                                                size="large"
                                                                sx={{ 
                                                                    '&:hover': { bgcolor: 'error.light', color: 'white' }
                                                                }}
                                                            >
                                                                <CustomIcons.Delete />
                                                            </IconButton>
                                                        </Box>
                                                    </TableCell>
                                                </TableRow>
                                            ))}
                                        </TableBody>
                                    </Table>
                                </TableContainer>
                            </Paper>
                        </Container>
                    </Box>

                    <Dialog open={dialogOpen} onClose={() => setDialogOpen(false)} maxWidth="md" fullWidth>
                        <DialogTitle>
                            {editingEmployee ? 'Edit Employee' : 'Add Employee'}
                        </DialogTitle>
                        <EmployeeForm
                            employee={editingEmployee}
                            onSave={handleSave}
                            onCancel={() => setDialogOpen(false)}
                        />
                    </Dialog>
                </React.Fragment>
            );
        };

        // Main Layout Component
        const Layout = ({ children }) => {
            const dispatch = useDispatch();
            const snackbar = useSelector(state => state.ui.snackbar);

            const handleSnackbarClose = () => {
                dispatch(hideSnackbar());
            };

            return (
                <ThemeProvider theme={theme}>
                    <CssBaseline />
                    <Box sx={{ minHeight: '100vh', display: 'flex', flexDirection: 'column' }}>
                        <Header />
                        <Box
                            component="main"
                            sx={{
                                flexGrow: 1,
                                pt: 12, // Increased padding to account for taller header with tabs
                                width: '100%',
                                display: 'flex',
                                justifyContent: 'center',
                            }}
                        >
                            <Container 
                                maxWidth="xl" 
                                sx={{ 
                                    py: 4,
                                    px: { xs: 2, sm: 3, md: 4 },
                                    width: '100%',
                                }}
                            >
                                {children}
                            </Container>
                        </Box>
                    </Box>
                    <Snackbar
                        open={snackbar.open}
                        autoHideDuration={4000}
                        onClose={handleSnackbarClose}
                        anchorOrigin={{ vertical: 'top', horizontal: 'right' }}
                    >
                        <Alert onClose={handleSnackbarClose} severity={snackbar.severity} sx={{ width: '100%' }}>
                            {snackbar.message}
                        </Alert>
                    </Snackbar>
                </ThemeProvider>
            );
        };

        // Page Renderer Component
        const PageRenderer = () => {
            const currentPage = useSelector(state => state.ui.currentPage);

            switch (currentPage) {
                case 'departments':
                    return <Departments />;
                case 'job-roles':
                    return <JobRoles />;
                case 'employees':
                    return <Employees />;
                case 'dashboard':
                default:
                    return <Dashboard />;
            }
        };

        // Main App Component
        const App = () => {
            return (
                <Provider store={store}>
                    <Layout>
                        <PageRenderer />
                    </Layout>
                </Provider>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
